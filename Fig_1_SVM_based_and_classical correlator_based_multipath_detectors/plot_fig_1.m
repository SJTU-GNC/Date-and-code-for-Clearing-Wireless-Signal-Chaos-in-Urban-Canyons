clear;
close all;
clc;

load viald_result_alp_fd.mat
load viald_result_tau_phi.mat
load viald_result_svm_tau_phi.mat
load viald_result_svm_alp_fd.mat


numColors = 10;
custom_map = [0.0314 0.0706 0.2275;
    0.1020 0.2118 0.3686;
    0.2588 0.5098 0.6627;
    0.3922 0.6784 0.7804;
    0.8510 0.9216 0.9373;
    0.8 0.8 0.8;
    0.9922 0.8039 0.6588;
    0.9804 0.6588 0.4510;
    0.8824 0.3098 0.1098;
    0.6510 0.0471 0.0157];


data_list = {
    result_svm_A_tau_phi{1}, result_svm_I_tau_phi{1}, ...
    result_svm_Q_tau_phi{1}, result_svm_IQ_tau_phi{1}, ...
    result_svm_A_alp_fd{1}, result_svm_I_alp_fd{1}, ...
    result_svm_Q_alp_fd{1}, result_svm_IQ_alp_fd{1}, ...
    result_A_tau_phi{1}, result_I_tau_phi{1}, ...
    result_Q_tau_phi{1}, result_IQ_tau_phi{1}, ...
    result_A_alp_fd{1}, result_I_alp_fd{1},...
    result_Q_alp_fd{1}, result_IQ_alp_fd{1}
    };


titles = {
    'result_svm_A_tau_phi', 'result_svm_I_tau_phi', ...
    'result_svm_Q_tau_phi', 'result_svm_IQ_tau_phi', ...
    'result_svm_A_alp_fd', 'result_svm_I_alp_fd', ...
    'result_svm_Q_alp_fd', 'result_svm_IQ_alp_fd', ...
    'result_A_tau_phi', 'result_I_tau_phi', ...
    'result_Q_tau_phi', 'result_IQ_tau_phi', ...
    'result_A_alp_fd', 'result_I_alp_fd',...
    'result_Q_alp_fd', 'result_IQ_alp_fd'
    };


level_lists = {
    [0,0.2,0.3,0.4,0.5,0.6,0.706,0.805,1], ...
    [0,0.2,0.3,0.4,0.5,0.6,0.706,0.805,1], ...
    [0,0.2,0.3,0.4,0.5,0.6,0.718,0.812,1], ...
    [0,0.2,0.3,0.4,0.5,0.6,0.725,0.815,1], ...
    [0,0.2,0.3,0.4,0.515,0.61,0.71,0.81,1], ...
    [0,0.2,0.3,0.4,0.515,0.613,0.71,0.81,1], ...
    [0, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 1], ...
    [0, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 1], ...,0.8,0.95
    [0, 0.22, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 1], ...
    [0,0.216,0.42,0.5,0.6,0.7,0.8,0.9], ...
    [0, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9], ...
    [0, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9], ...
    [0, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 1], ...
    [0, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 1], ...
    [0,0.2,0.3,0.4,0.52,0.612,0.71,0.81,1], ...
    [0,0.2,0.3,0.4,0.52,0.612,0.71,0.81,1]
    };

for i = 1:16
    figure('Position', [200, 100, 1200, 500], 'Color', 'white');

    Z = data_list{i};
    z_min = min(Z(:));
    z_max = max(Z(:));
    levels = linspace(0, z_max, numColors + 1);

    hold on;
    [C, h] = contour(Z, 10, 'LineColor', [0.6 0.6 0.6], ...
        'LineWidth', 1.5, 'LineStyle', '--', 'LabelSpacing', 3000);
    h.LevelList = level_lists{i};

    set(gca, 'YDir', 'normal', 'Box', 'off', 'TickDir', 'out', ...
        'LineWidth', 1, 'FontName', 'Helvetica', 'FontSize', 25);

    colormap(custom_map);
    caxis([z_min, z_max]);

    cbar = colorbar('eastoutside', 'Ticks', 0:0.2:1, ...
        'TickDirection', 'out', 'Box', 'off', 'LineWidth', 1);
    cbar.Label.String = 'Detection Rate';
    cbar.Label.FontSize = 25;
    cbar.Label.FontName = 'Helvetica';

    tick_positions = (levels(1:end-1) + levels(2:end)) / 2;
    set(cbar, 'Ticks', tick_positions);
    cbar.TickLabels = {'0.1', '0.2', '0.3', '0.4', '0.5', '0.6', '0.7', '0.8', '0.9', '1'};

    if i <= 4
        xlabel('Relative delay (chip)', 'FontSize', 25, 'FontName', 'Helvetica');
        ylabel('Relative phase (°)', 'FontSize', 25, 'FontName', 'Helvetica');
        set(gca, 'XTick', [1, 30, 60, 90, 120, 150], ...
            'XTickLabel', {'0', '0.3', '0.6', '0.9', '1.2', '1.5'}, ...
            'YTick', [0, 30, 60, 90, 120, 150, 180], ...
            'YTickLabel', {'0', '30', '60', '90', '120', '150', '180'});
    elseif (i>4&&i<=8)||(i>12&&i<=16)
        xlabel('Energy attenuation(dB)', 'FontSize', 25, 'FontName', 'Times New Roman');
        ylabel('Relative Doppler (Hz)', 'FontSize', 25, 'FontName', 'Times New Roman');
        set(gca, 'YTick', [1, 10, 19, 28], ...
            'YTickLabel', {'10^{-1}', '10^{0}', '10^{1}', '10^{2}'});
        set(gcf, 'Units', 'centimeters', 'Position', [6 6 20 15]);
    elseif 8<i<=12
        xlabel('Relative delay (chip)','FontSize',25,'FontName','Helvetica');
        ylabel('Relative phase (°)','FontSize',25,'FontName','Helvetica');
        set(gca,'FontName','Helvetica','FontSize', 25,'XTick',[1,30,60,90,120,150],'XTickLabel',{'0','0.3','0.6','0.9','1.2','1.5'},'YTick',...
            [0 100-16.67*5 100-16.67*4 100-16.67*3 100-16.67*2 100-16.67 100],'YTickLabel',...
            {'0','30','60','90','120','150','180'});
    end
end
